"use strict";(self["webpackChunkvue3_nb0"]=self["webpackChunkvue3_nb0"]||[]).push([[8],{40008:(e,l,n)=>{n.r(l),n.d(l,{default:()=>W});n(19680),n(97479),n(79921),n(80078),n(65928),n(85709),n(35915),n(30754),n(67684),n(93439),n(39741),n(53653),n(9034),n(92882),n(9130),n(47872),n(69983),n(33922);var t=n(55701),a=n(19588),u=(n(26514),n(52679)),r=n(26956),i=n(26781),o=n(32259),c=n(78193),s=n(3542),v=(n(2608),n(5625),n(40054),n(70118),{class:"formModel_btn_box"});const d={__name:"formModel",emits:["formModelChange"],setup:function(e,l){var n,a=l.expose,r=l.emit,i=(0,o.oR)(),d=(0,t.Fl)((function(){return i.getters["user/session"]})),f=null===(n=(0,t.FN)())||void 0===n?void 0:n.appContext.config.globalProperties,p="messages",m="意见反馈",g=(0,u.iH)({}),h=(0,u.iH)({userid:!1,username:!1,avatarurl:!1,content:!1,cpicture:!1,reply:!1,rpicture:!1}),w=(0,u.iH)(!1),_=(0,u.iH)(!1),y=(0,u.iH)(""),k=(0,u.iH)({userid:[{required:!0,message:"请输入",trigger:"blur"}],username:[],avatarurl:[],content:[{required:!0,message:"请输入",trigger:"blur"}],cpicture:[],reply:[],rpicture:[]}),b=(0,u.iH)(null),H=(0,u.iH)(0),C=(0,u.iH)(""),W=function(){g.value={userid:"",username:"",avatarurl:"",content:"",cpicture:"",reply:"",rpicture:""}},x=function(){null===f||void 0===f||f.$http({url:"".concat(p,"/info/").concat(H.value),method:"get"}).then((function(e){new RegExp("../../../file","g");g.value=e.data.data,w.value=!0}))},U=(0,u.iH)(""),$=(0,u.iH)(""),Z=(0,u.iH)(""),z=(0,u.iH)(""),M=(0,u.iH)(""),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(W(),e&&(H.value=e,C.value=l),"add"==l)_.value=!0,y.value="新增"+m,w.value=!0;else if("info"==l)_.value=!1,y.value="查看"+m,x();else if("edit"==l)_.value=!0,y.value="修改"+m,x();else if("reply"==l)C.value=l,_.value=!0,h.value.cpicture=!0,h.value.content=!0,y.value="回复",x();else if("cross"==l){for(var o in _.value=!0,y.value=n,t)"userid"!=o?"username"!=o?"avatarurl"!=o?"content"!=o?"cpicture"!=o?"reply"!=o?"rpicture"!=o||(g.value.rpicture=t[o],h.value.rpicture=!0):(g.value.reply=t[o],h.value.reply=!0):(g.value.cpicture=t[o],h.value.cpicture=!0):(g.value.content=t[o],h.value.content=!0):(g.value.avatarurl=t[o],h.value.avatarurl=!0):(g.value.username=t[o],h.value.username=!0):(g.value.userid=t[o],h.value.userid=!0);t&&(U.value=t),a&&($.value=a),r&&(Z.value=r),u&&(z.value=u),i&&(M.value=i),w.value=!0}};a({init:j});var R=function(){w.value=!1},q=function(e,l){g.value[l]=e},N=function(){var e=(0,s.Z)((0,c.Z)().mark((function e(){var l,n,t,a,u;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=g.value.avatarurl&&(g.value.avatarurl=g.value.avatarurl.replace(new RegExp(null===f||void 0===f?void 0:f.$config.url,"g"),"")),null!=g.value.cpicture&&(g.value.cpicture=g.value.cpicture.replace(new RegExp(null===f||void 0===f?void 0:f.$config.url,"g"),"")),null!=g.value.rpicture&&(g.value.rpicture=g.value.rpicture.replace(new RegExp(null===f||void 0===f?void 0:f.$config.url,"g"),"")),$.value,l=JSON.parse(JSON.stringify(U.value)),n="",t="",a="","cross"==C.value&&""!=z.value)if(z.value.startsWith("["))n=d.value.id,t=l["id"],a=z.value.replace(/\[/,"").replace(/\]/,"");else{for(u in l)u==z.value&&(l[u]=M.value);S(l)}b.value.validate((function(e){if(e)if(n&&t){g.value.crossuserid=n,g.value.crossrefid=t;var l={page:1,limit:1e3,crossuserid:g.value.crossuserid,crossrefid:g.value.crossrefid};null===f||void 0===f||f.$http({url:"".concat(p,"/page"),method:"get",params:l}).then((function(e){if(e.data.data.total>=a)return null===f||void 0===f||f.$toolUtil.message("".concat(Z.value),"error"),!1;null===f||void 0===f||f.$http({url:"".concat(p,"/").concat(g.value.id?"update":"save"),method:"post",data:g.value}).then(function(){var e=(0,s.Z)((0,c.Z)().mark((function e(l){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r("formModelChange"),null===f||void 0===f||f.$toolUtil.message("操作成功","success"),w.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(l){return e.apply(this,arguments)}}())}))}else null===f||void 0===f||f.$http({url:"".concat(p,"/").concat(g.value.id?"update":"save"),method:"post",data:g.value}).then(function(){var e=(0,s.Z)((0,c.Z)().mark((function e(l){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r("formModelChange"),null===f||void 0===f||f.$toolUtil.message("操作成功","success"),w.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(l){return e.apply(this,arguments)}}())}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,s.Z)((0,c.Z)().mark((function e(l){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,null===f||void 0===f?void 0:f.$http({url:"".concat($.value,"/update"),method:"post",data:l}).then((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(l){return e.apply(this,arguments)}}();return function(e,l){var n=(0,t.up)("el-input"),a=(0,t.up)("el-form-item"),u=(0,t.up)("el-col"),r=(0,t.up)("editor"),i=(0,t.up)("el-row"),o=(0,t.up)("el-form"),c=(0,t.up)("el-button"),s=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(s,{"modal-class":"edit_form_modal",class:"edit_form",modelValue:w.value,"onUpdate:modelValue":l[3]||(l[3]=function(e){return w.value=e}),title:y.value,width:"60%","destroy-on-close":"",fullscreen:!1},(0,t.Nv)({default:(0,t.w5)((function(){return[(0,t.Wm)(o,{class:"formModel_form",ref_key:"formRef",ref:b,model:g.value,rules:k.value},{default:(0,t.w5)((function(){return[(0,t.Wm)(i,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(u,{span:12},{default:(0,t.w5)((function(){return[(0,t.Wm)(a,{label:"用户名",prop:"username"},{default:(0,t.w5)((function(){return[(0,t.Wm)(n,{class:"list_inp",modelValue:g.value.username,"onUpdate:modelValue":l[0]||(l[0]=function(e){return g.value.username=e}),placeholder:"用户名",type:"text",readonly:""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,t.Wm)(u,{span:24},{default:(0,t.w5)((function(){return[(0,t.Wm)(a,{label:"留言内容",prop:"content"},{default:(0,t.w5)((function(){return[(0,t.Wm)(r,{value:g.value.content,placeholder:"请输入留言内容",readonly:!0,class:"list_editor",onChange:l[1]||(l[1]=function(e){return q(e,"content")})},null,8,["value"])]})),_:1})]})),_:1}),(0,t.Wm)(u,{span:24},{default:(0,t.w5)((function(){return[(0,t.Wm)(a,{label:"回复内容",prop:"reply"},{default:(0,t.w5)((function(){return[(0,t.Wm)(r,{value:g.value.reply,placeholder:"请输入回复内容",readonly:!_.value,class:"list_editor",onChange:l[2]||(l[2]=function(e){return q(e,"reply")})},null,8,["value","readonly"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:2},[_.value||"logistics"==C.value||"reply"==C.value?{name:"footer",fn:(0,t.w5)((function(){return[(0,t._)("span",v,[(0,t.Wm)(c,{class:"cancel_btn",onClick:R},{default:(0,t.w5)((function(){return[(0,t.Uk)("取消")]})),_:1}),(0,t.Wm)(c,{class:"confirm_btn",type:"primary",onClick:N},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 提交 ")]})),_:1})])]})),key:"0"}:void 0]),1032,["modelValue","title"])])}}};var f=n(23927);const p=(0,f.Z)(d,[["__scopeId","data-v-63198285"]]),m=p;n(56348);var g=function(e){return(0,t.dD)("data-v-021da4c6"),e=e(),(0,t.Cn)(),e},h={class:"center_view"},w={class:"list_search_view"},_={class:"btn_view"},y=g((function(){return(0,t._)("br",null,null,-1)})),k=["innerHTML"],b=["innerHTML"];const H={__name:"list",setup:function(e){var l,n=(0,o.oR)(),c=((0,t.Fl)((function(){return n.getters["user/session"]})),(0,u.iH)(n.state.user.avatar),null===(l=(0,t.FN)())||void 0===l?void 0:l.appContext.config.globalProperties),s="messages",v="意见反馈";(0,r.yj)();(0,t.bv)((function(){}));var d=(0,u.iH)(null),f=(0,u.iH)(null),p=(0,u.iH)({page:1,limit:10,sort:"id",order:"desc"}),g=(0,u.iH)({}),H=(0,u.iH)([]),C=(0,u.iH)(!1),W=function(e){(0,t.Y3)((function(){f.value.toggleRowSelection(e)}))},x=function(){C.value=!0;var e=JSON.parse(JSON.stringify(p.value));e["sort"]="id",e["order"]="desc",null===c||void 0===c||c.$http({url:"".concat(s,"/page"),method:"get",params:e}).then((function(e){C.value=!1,d.value=e.data.data.list,Z.value=Number(e.data.data.total)}))},U=function(e){var l=(0,u.iH)([]);if(e)l.value=[e];else{if(!H.value.length)return!1;for(var n in H.value)l.value.push(H.value[n].id)}i.T.confirm("是否删除选中".concat(v),"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then((function(){null===c||void 0===c||c.$http({url:"".concat(s,"/delete"),method:"post",data:l.value}).then((function(e){null===c||void 0===c||c.$toolUtil.message("删除成功","success",(function(){x()}))}))}))},$=function(e){H.value=e},Z=(0,u.iH)(0),z=(0,u.iH)(["total","prev","pager","next","sizes","jumper"]),M=function(e){p.value.limit=e,x()},j=function(e){p.value.page=e,x()},R=function(e,l){return null===c||void 0===c?void 0:c.$toolUtil.isAuth(e,l)},q=function(){p.value.page=1,x()},N=(0,u.iH)(null),S=function(){q()},T=function(){N.value.init()},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?N.value.init(e,"edit"):H.value.length&&N.value.init(H.value[0].id,"edit")},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?N.value.init(e,"info"):H.value.length&&N.value.init(H.value[0].id,"info")},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;N.value.init(e,"reply")},J=function(){x()};return J(),function(e,l){var n=(0,t.up)("el-form"),u=(0,t.up)("el-button"),r=(0,t.up)("el-table-column"),i=(0,t.up)("el-table"),o=(0,t.up)("el-pagination"),c=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("div",h,[(0,t._)("div",w,[(0,t.Wm)(n,{model:g.value,class:"search_form"},null,8,["model"]),(0,t._)("div",_,[R("messages","新增")?((0,t.wg)(),(0,t.j4)(u,{key:0,class:"add_btn",type:"success",onClick:T},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 新增 ")]})),_:1})):(0,t.kq)("",!0),R("messages","删除")?((0,t.wg)(),(0,t.j4)(u,{key:1,class:"del_btn",type:"danger",disabled:!H.value.length,onClick:l[0]||(l[0]=function(e){return U(null)})},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 删除 ")]})),_:1},8,["disabled"])):(0,t.kq)("",!0)])]),y,R("messages","查看")?(0,t.wy)(((0,t.wg)(),(0,t.j4)(i,{key:0,border:"",stripe:!1,onSelectionChange:$,ref_key:"table",ref:f,data:d.value,onRowClick:W},{default:(0,t.w5)((function(){return[(0,t.Wm)(r,{resizable:!0,align:"left","header-align":"left",type:"selection",width:"55"}),(0,t.Wm)(r,{label:"序号",width:"70",resizable:!0,align:"left","header-align":"left"},{default:(0,t.w5)((function(e){return[(0,t.Uk)((0,a.zw)((p.value.page-1)*p.value.limit+e.$index+1),1)]})),_:1}),(0,t.Wm)(r,{"min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left",prop:"username",label:"用户名"},{default:(0,t.w5)((function(e){return[(0,t.Uk)((0,a.zw)(e.row.username),1)]})),_:1}),(0,t.Wm)(r,{label:"留言内容","min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left"},{default:(0,t.w5)((function(e){return[(0,t._)("span",{innerHTML:e.row.content},null,8,k)]})),_:1}),(0,t.Wm)(r,{label:"回复内容","min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left"},{default:(0,t.w5)((function(e){return[(0,t._)("span",{innerHTML:e.row.reply},null,8,b)]})),_:1}),(0,t.Wm)(r,{label:"操作",width:"300",resizable:!0,sortable:!0,align:"left","header-align":"left"},{default:(0,t.w5)((function(e){return[R("messages","查看")?((0,t.wg)(),(0,t.j4)(u,{key:0,class:"view_btn",type:"info",onClick:function(l){return F(e.row.id)}},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 详情 ")]})),_:2},1032,["onClick"])):(0,t.kq)("",!0),R("messages","修改")?((0,t.wg)(),(0,t.j4)(u,{key:1,class:"edit_btn",type:"primary",onClick:function(l){return V(e.row.id)}},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 修改 ")]})),_:2},1032,["onClick"])):(0,t.kq)("",!0),R("messages","删除")?((0,t.wg)(),(0,t.j4)(u,{key:2,class:"del_btn",type:"danger",onClick:function(l){return U(e.row.id)}},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 删除 ")]})),_:2},1032,["onClick"])):(0,t.kq)("",!0),R("messages","回复")?((0,t.wg)(),(0,t.j4)(u,{key:3,class:"operate_btn",type:"warning",onClick:function(l){return E(e.row.id)}},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 回复 ")]})),_:2},1032,["onClick"])):(0,t.kq)("",!0)]})),_:1})]})),_:1},8,["data"])),[[c,C.value]]):(0,t.kq)("",!0),(0,t.Wm)(o,{background:"",layout:z.value.join(","),total:Z.value,"page-size":p.value.limit,"prev-text":"上一页","next-text":"下一页","hide-on-single-page":!1,style:{},"page-sizes":[10,20,30,40,50,100],onSizeChange:M,onCurrentChange:j},null,8,["layout","total","page-size"])]),(0,t.Wm)(m,{ref_key:"formRef",ref:N,onFormModelChange:S},null,512)])}}},C=(0,f.Z)(H,[["__scopeId","data-v-021da4c6"]]),W=C}}]);
//# sourceMappingURL=8.5184c645.js.map